#!/usr/bin/env node
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _map=require("babel-runtime/core-js/map"),_map2=_interopRequireDefault(_map),_set=require("babel-runtime/core-js/set"),_set2=_interopRequireDefault(_set),_minimist=require("minimist"),_minimist2=_interopRequireDefault(_minimist),_path=require("path"),_crossSpawnAsync=require("cross-spawn-async"),_checkUpdate=require("../lib/check-update"),_checkUpdate2=_interopRequireDefault(_checkUpdate),argv=(0,_minimist2.default)(process.argv.slice(2)),debug=argv.debug||argv.d,update=(0,_checkUpdate2.default)({debug:debug}),exit=function(e){update.then(function(){return process.exit(e)}),setTimeout(function(){return process.exit(e)},1e3)},defaultCommand="deploy",commands=new _set2.default([defaultCommand,"list","ls","rm","remove","alias","aliases","ln","domain","domains"]),aliases=new _map2.default([["ls","list"],["rm","remove"],["ln","alias"],["aliases","alias"],["domain","domains"]]),cmd=argv._[0],args=[];"help"===cmd&&(cmd=argv._[1],commands.has(cmd)||(cmd=defaultCommand),args.push("--help")),commands.has(cmd)?(cmd=aliases.get(cmd)||cmd,args=args.concat(process.argv.slice(3))):(cmd=defaultCommand,args=args.concat(process.argv.slice(2)));var bin=(0,_path.resolve)(__dirname,"now-"+cmd);process.enclose&&(args.unshift("--entrypoint",bin),bin=process.execPath);var proc=(0,_crossSpawnAsync.spawn)(bin,args,{stdio:"inherit",customFds:[0,1,2]});proc.on("close",function(e){return exit(e)}),proc.on("error",function(){return exit(1)});